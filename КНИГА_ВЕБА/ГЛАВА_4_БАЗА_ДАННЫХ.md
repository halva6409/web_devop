# üìñ –ì–õ–ê–í–ê 4: –ë–ê–ó–ê –î–ê–ù–ù–´–• - –•–†–ê–ù–ò–õ–ò–©–ï –ò–ù–§–û–†–ú–ê–¶–ò–ò

## üéØ –¶–µ–ª—å —ç—Ç–æ–π –≥–ª–∞–≤—ã
–¢—ã –ø–æ–π–º—ë—à—å:
- –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- SQL ‚Äî —è–∑—ã–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- –ö–∞–∫ —Å–≤—è–∑–∞—Ç—å Python —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (Create, Read, Update, Delete)

---

## üíæ –ß–ê–°–¢–¨ 1: –ß–¢–û –¢–ê–ö–û–ï –ë–ê–ó–ê –î–ê–ù–ù–´–•?

### –ê–Ω–∞–ª–æ–≥–∏—è: –ö–∏–Ω–æ-–∞—Ä—Ö–∏–≤

```
üìº –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (CSV —Ñ–∞–π–ª—ã):
file1.csv
‚îú‚îÄ‚îÄ –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ä–µ–∂–∏—Å—Å–µ—Ä, –≥–æ–¥, –±—é–¥–∂–µ—Ç
‚îú‚îÄ‚îÄ –ú–∞—Ç—Ä–∏—Ü–∞, –í–∞—á–æ–≤—Å–∫–∏, 1999, 63000000
‚îî‚îÄ‚îÄ –ê–≤–∞—Ç–∞—Ä, –ö–∞–º–µ—Ä–æ–Ω, 2009, 237000000

‚ùå –ü—Ä–æ–±–ª–µ–º—ã:
- –ú–µ–¥–ª–µ–Ω–Ω–æ –∏—Å–∫–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∏–ª—å–º
- –¢—Ä—É–¥–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É
- –†–∏—Å–∫–æ–≤–∞–Ω–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö

üíæ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± (SQL –±–∞–∑–∞):
database.db
‚îú‚îÄ‚îÄ films (—Ç–∞–±–ª–∏—Ü–∞)
‚îÇ   ‚îú‚îÄ‚îÄ id, title, director, year, budget
‚îÇ   ‚îú‚îÄ‚îÄ 1, –ú–∞—Ç—Ä–∏—Ü–∞, –í–∞—á–æ–≤—Å–∫–∏, 1999, 63000000
‚îÇ   ‚îî‚îÄ‚îÄ 2, –ê–≤–∞—Ç–∞—Ä, –ö–∞–º–µ—Ä–æ–Ω, 2009, 237000000
‚îú‚îÄ‚îÄ orders (–¥—Ä—É–≥–∞—è —Ç–∞–±–ª–∏—Ü–∞)
‚îÇ   ‚îú‚îÄ‚îÄ id, film_id, user_id, date
‚îÇ   ‚îî‚îÄ‚îÄ 1, 1, 123, 2024-01-15
‚îî‚îÄ‚îÄ users (—Ç—Ä–µ—Ç—å—è —Ç–∞–±–ª–∏—Ü–∞)
    ‚îú‚îÄ‚îÄ id, name, email
    ‚îî‚îÄ‚îÄ 123, –ò–≤–∞–Ω, ivan@example.com

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –¥–∞–∂–µ –≤ –º–∏–ª–ª–∏–æ–Ω–∞—Ö –∑–∞–ø–∏—Å–µ–π
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞)
- –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å (—Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏)
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–∏–Ω–∏–º—É–º –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
```

### –ì–ª–∞–≤–Ω—ã–µ —Ç–∏–ø—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

| –ë–î | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–∏–º–µ—Ä |
|-----|------------------|--------|
| **SQL (—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ)** | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ | MySQL, PostgreSQL, SQLite |
| **NoSQL (–¥–æ–∫—É–º–µ–Ω—Ç–Ω—ã–µ)** | –ì–∏–±–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –±–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã | MongoDB, CouchDB |
| **In-memory** | –°–∫–æ—Ä–æ—Å—Ç—å –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | Redis, Memcached |

**–í —ç—Ç–æ–º –∫—É—Ä—Å–µ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å:** SQLite (–≤—Å—Ç—Ä–æ–µ–Ω –≤ Python!)

---

## üìä –ß–ê–°–¢–¨ 2: –¢–ê–ë–õ–ò–¶–´ –ò –°–•–ï–ú–´

### –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

```
–¢–∞–±–ª–∏—Ü–∞ = Excel –ª–∏—Å—Ç

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ title            ‚îÇ source      ‚îÇ date ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1   ‚îÇ COVID-19 –≤–∞–∫—Ü–∏–Ω–∞ ‚îÇ BBC         ‚îÇ 2021 ‚îÇ
‚îÇ 2   ‚îÇ –ö–ª–∏–º–∞—Ç –º–µ–Ω—è–µ—Ç—Å—è  ‚îÇ Reuters     ‚îÇ 2024 ‚îÇ
‚îÇ 3   ‚îÇ –ù–æ–≤–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è ‚îÇ TechCrunch  ‚îÇ 2024 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ö–æ–ª–æ–Ω–∫–∏ (—Å—Ç–æ–ª–±—Ü—ã):
- id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä (PRIMARY KEY)
- title: –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏ (TEXT)
- source: –∏—Å—Ç–æ—á–Ω–∏–∫ (TEXT)
- date: –¥–∞—Ç–∞ (INTEGER –∏–ª–∏ DATE)
```

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ SQL

```sql
INTEGER     -- –¶–µ–ª–æ–µ —á–∏—Å–ª–æ (-2147483648 –¥–æ 2147483647)
REAL        -- –î—Ä–æ–±–Ω–æ–µ —á–∏—Å–ª–æ (3.14, 2.71)
TEXT        -- –¢–µ–∫—Å—Ç (–º–∞–∫—Å–∏–º—É–º 2 –ì–ë)
BLOB        -- –ë–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ)
DATE        -- –î–∞—Ç–∞ (2024-01-15)
BOOLEAN     -- true/false (1/0)
NULL        -- –ü—É—Å—Ç–æ (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã

```sql
CREATE TABLE news (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    description TEXT,
    source TEXT NOT NULL,
    url TEXT UNIQUE,
    published_date DATE,
    is_archived INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `INTEGER PRIMARY KEY AUTOINCREMENT` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π id, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
- `NOT NULL` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ)
- `UNIQUE` - –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è (–∫–∞–∂–¥—ã–π URL —É–Ω–∏–∫–∞–ª–µ–Ω)
- `DEFAULT 0` - –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –±—É–¥–µ—Ç 0
- `TIMESTAMP DEFAULT CURRENT_TIMESTAMP` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

---

## üîç –ß–ê–°–¢–¨ 3: SQL - –Ø–ó–´–ö –ó–ê–ü–†–û–°–û–í

### CREATE - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –°–ø–æ—Å–æ–± 1: –£–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–ª–æ–Ω–∫–∏
INSERT INTO news (title, description, source, url, published_date)
VALUES (
    '–ù–æ–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≤ –Ω–∞—É–∫–µ',
    '–£—á—ë–Ω—ã–µ –æ—Ç–∫—Ä—ã–ª–∏...',
    'Science Daily',
    'https://...',
    '2024-01-15'
);

-- –°–ø–æ—Å–æ–± 2: –ë—ã—Å—Ç—Ä–æ (–±–µ–∑ description)
INSERT INTO news (title, source, url)
VALUES ('–ó–∞–≥–æ–ª–æ–≤–æ–∫', 'BBC', 'https://...');

-- –î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ä–∞–∑—É
INSERT INTO news (title, source) VALUES
    ('–ù–æ–≤–æ—Å—Ç—å 1', 'BBC'),
    ('–ù–æ–≤–æ—Å—Ç—å 2', 'Reuters'),
    ('–ù–æ–≤–æ—Å—Ç—å 3', 'CNN');
```

### READ - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏
SELECT * FROM news;

-- –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
SELECT title, source, published_date FROM news;

-- WHERE - —É—Å–ª–æ–≤–∏–µ (—Ñ–∏–ª—å—Ç—Ä)
SELECT * FROM news WHERE source = 'BBC';
SELECT * FROM news WHERE id > 5;
SELECT * FROM news WHERE title LIKE '%—Å–∫–æ—Ä–æ—Å—Ç—å%';  -- –°–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ

-- ORDER BY - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
SELECT * FROM news ORDER BY published_date;           -- –û—Ç —Å—Ç–∞—Ä—ã—Ö –∫ –Ω–æ–≤—ã–º
SELECT * FROM news ORDER BY published_date DESC;      -- –û—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º
SELECT * FROM news ORDER BY id DESC LIMIT 10;         -- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10

-- LIMIT - –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
SELECT * FROM news LIMIT 5;                   -- –ü–µ—Ä–≤—ã–µ 5
SELECT * FROM news LIMIT 5 OFFSET 10;         -- –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å 10, –ø–æ—Ç–æ–º 5

-- COUNT - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
SELECT COUNT(*) FROM news;                    -- –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π
SELECT COUNT(*) FROM news WHERE source='BBC'; -- –°–∫–æ–ª—å–∫–æ –æ—Ç BBC

-- –°–ª–æ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
SELECT * FROM news
WHERE source = 'BBC' AND published_date > '2024-01-01';

SELECT * FROM news
WHERE source IN ('BBC', 'Reuters', 'CNN');  -- –û–¥–∏–Ω –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö

SELECT * FROM news
WHERE title IS NOT NULL;  -- –ù–µ –ø—É—Å—Ç–æ
```

### UPDATE - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –û–±–Ω–æ–≤–∏—Ç—å –æ–¥–Ω—É –Ω–æ–≤–æ—Å—Ç—å
UPDATE news
SET is_archived = 1
WHERE id = 5;

-- –û–±–Ω–æ–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π
UPDATE news
SET source = 'BBC News', published_date = '2024-01-16'
WHERE id = 3;

-- –û–±–Ω–æ–≤–∏—Ç—å –º–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π
UPDATE news
SET is_archived = 1
WHERE published_date < '2024-01-01';

-- –° –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é! (–±–µ–∑ WHERE –æ–±–Ω–æ–≤–∏—Ç –≤—Å—ë)
UPDATE news SET is_archived = 0;  -- –†–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –í–°–ï!
```

### DELETE - –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å
DELETE FROM news WHERE id = 5;

-- –£–¥–∞–ª–∏—Ç—å –º–Ω–æ–≥–æ
DELETE FROM news WHERE is_archived = 1;

-- –£–¥–∞–ª–∏—Ç—å –í–°–ï–ï (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
DELETE FROM news;  -- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏—Å—á–µ–∑–Ω—É—Ç!

-- –õ—É—á—à–µ –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω—É—é (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)
ALTER TABLE news ADD COLUMN is_deleted INTEGER DEFAULT 0;
UPDATE news SET is_deleted = 1 WHERE id = 5;
SELECT * FROM news WHERE is_deleted = 0;  -- –°—á–∏—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
```

---

## üêç –ß–ê–°–¢–¨ 4: PYTHON –ò –ë–ê–ó–ê –î–ê–ù–ù–´–•

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite

```python
import sqlite3

# –û—Ç–∫—Ä—ã—Ç—å (–∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å) –±–∞–∑—É
db = sqlite3.connect('news.db')

# –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å–æ—Ä (—ç—Ç–æ –æ–±—ä–µ–∫—Ç –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥)
cursor = db.cursor()

# –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å
cursor.execute('''
    CREATE TABLE IF NOT EXISTS news (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        title TEXT NOT NULL,
        source TEXT NOT NULL,
        published_date DATE
    )
''')

# –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
db.commit()

# –ó–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
db.close()
```

### CRUD –≤ Python

```python
import sqlite3

def get_connection():
    """–§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î"""
    return sqlite3.connect('news.db')

# ===== CREATE (–î–æ–±–∞–≤–ª–µ–Ω–∏–µ) =====
def add_news(title, source):
    db = get_connection()
    cursor = db.cursor()
    
    cursor.execute('''
        INSERT INTO news (title, source)
        VALUES (?, ?)
    ''', (title, source))
    
    db.commit()
    news_id = cursor.lastrowid  # –ü–æ–ª—É—á–∏—Ç—å ID –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
    print(f"–ù–æ–≤–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å ID {news_id}")
    
    db.close()

# add_news("–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏", "BBC")

# ===== READ (–ß—Ç–µ–Ω–∏–µ) =====
def get_all_news():
    db = get_connection()
    cursor = db.cursor()
    
    cursor.execute('SELECT id, title, source FROM news ORDER BY id DESC')
    
    # fetchall() - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    news_list = cursor.fetchall()
    db.close()
    
    return news_list

# results = get_all_news()
# for id, title, source in results:
#     print(f"{id}. {title} ({source})")

def get_news_by_id(news_id):
    db = get_connection()
    cursor = db.cursor()
    
    cursor.execute('SELECT * FROM news WHERE id = ?', (news_id,))
    
    # fetchone() - –ø–æ–ª—É—á–∏—Ç—å –æ–¥–Ω—É –∑–∞–ø–∏—Å—å
    news = cursor.fetchone()
    db.close()
    
    return news

def search_news(query):
    db = get_connection()
    cursor = db.cursor()
    
    # LIKE —Å % –æ–∑–Ω–∞—á–∞–µ—Ç "—Å–æ–¥–µ—Ä–∂–∏—Ç"
    cursor.execute('''
        SELECT id, title, source FROM news
        WHERE title LIKE ? OR source LIKE ?
    ''', (f'%{query}%', f'%{query}%'))
    
    results = cursor.fetchall()
    db.close()
    return results

# ===== UPDATE (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ) =====
def update_news(news_id, new_title):
    db = get_connection()
    cursor = db.cursor()
    
    cursor.execute('''
        UPDATE news
        SET title = ?
        WHERE id = ?
    ''', (new_title, news_id))
    
    db.commit()
    db.close()

# update_news(1, "–ù–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫")

# ===== DELETE (–£–¥–∞–ª–µ–Ω–∏–µ) =====
def delete_news(news_id):
    db = get_connection()
    cursor = db.cursor()
    
    cursor.execute('DELETE FROM news WHERE id = ?', (news_id,))
    
    db.commit()
    db.close()

# delete_news(1)
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: SQL Injection

```python
# ‚ùå –û–ü–ê–°–ù–û! –ù–µ –¥–µ–ª–∞–π —Ç–∞–∫!
user_input = "'; DROP TABLE news; --"
query = f"SELECT * FROM news WHERE title = '{user_input}'"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: SELECT * FROM news WHERE title = ''; DROP TABLE news; --'
# –≠—Ç–æ —É–¥–∞–ª–∏—Ç —Ç–∞–±–ª–∏—Ü—É!

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û! –ò—Å–ø–æ–ª—å–∑—É–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
cursor.execute('SELECT * FROM news WHERE title = ?', (user_input,))
# Python —Å–∞–º —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
```

---

## üîê –ß–ê–°–¢–¨ 5: –û–¢–ù–û–®–ï–ù–ò–Ø –ú–ï–ñ–î–£ –¢–ê–ë–õ–ò–¶–ê–ú–ò

### –û–¥–Ω–∞ –∫–æ –º–Ω–æ–≥–∏–º (One-to-Many)

```
–û–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ú–ù–û–ì–û –Ω–æ–≤–æ—Å—Ç–µ–π

tab sources (–∏—Å—Ç–æ—á–Ω–∏–∫–∏)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ name            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1   ‚îÇ BBC             ‚îÇ
‚îÇ 2   ‚îÇ Reuters         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

table news (–Ω–æ–≤–æ—Å—Ç–∏)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ title            ‚îÇ source_id ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1   ‚îÇ –ù–æ–≤–æ—Å—Ç—å 1        ‚îÇ 1         ‚îÇ ‚Üê BBC
‚îÇ 2   ‚îÇ –ù–æ–≤–æ—Å—Ç—å 2        ‚îÇ 1         ‚îÇ ‚Üê BBC
‚îÇ 3   ‚îÇ –ù–æ–≤–æ—Å—Ç—å 3        ‚îÇ 2         ‚îÇ ‚Üê Reuters
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**SQL:**
```sql
CREATE TABLE sources (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL UNIQUE
);

CREATE TABLE news (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    title TEXT NOT NULL,
    source_id INTEGER NOT NULL,
    FOREIGN KEY (source_id) REFERENCES sources(id)
);
```

**–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –æ—Ç BBC:**
```sql
SELECT news.title
FROM news
JOIN sources ON news.source_id = sources.id
WHERE sources.name = 'BBC';
```

**Python:**
```python
def get_news_by_source(source_name):
    db = get_connection()
    cursor = db.cursor()
    
    cursor.execute('''
        SELECT news.id, news.title
        FROM news
        JOIN sources ON news.source_id = sources.id
        WHERE sources.name = ?
    ''', (source_name,))
    
    return cursor.fetchall()
```

---

## üìà –ß–ê–°–¢–¨ 6: –†–ê–°–®–ò–†–ï–ù–ù–´–ï –û–ü–ï–†–ê–¶–ò–ò

### –ê–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

```sql
-- COUNT - —Å—á–∏—Ç–∞—Ç—å –∑–∞–ø–∏—Å–∏
SELECT COUNT(*) AS total_news FROM news;

-- SUM - —Å—É–º–º–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è)
SELECT SUM(views) FROM news;

-- AVG - —Å—Ä–µ–¥–Ω–µ–µ
SELECT AVG(views) FROM news;

-- MIN/MAX - –º–∏–Ω–∏–º—É–º/–º–∞–∫—Å–∏–º—É–º
SELECT MIN(published_date), MAX(published_date) FROM news;

-- GROUP BY - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∏ —Å—á–∏—Ç–∞—Ç—å
SELECT source, COUNT(*) as count
FROM news
GROUP BY source
ORDER BY count DESC;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ source  ‚îÇ count ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ BBC     ‚îÇ 15    ‚îÇ
‚îÇ Reuters ‚îÇ 12    ‚îÇ
‚îÇ CNN     ‚îÇ 8     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

```python
def transfer_news(from_source_id, to_source_id, news_id):
    """–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π"""
    db = get_connection()
    cursor = db.cursor()
    
    try:
        # –ù–∞—á–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        cursor.execute('BEGIN TRANSACTION')
        
        # –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–æ–≤–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        cursor.execute('SELECT id FROM news WHERE id = ?', (news_id,))
        if not cursor.fetchone():
            raise Exception("–ù–æ–≤–æ—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        
        # –®–∞–≥ 2: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å
        cursor.execute('''
            UPDATE news
            SET source_id = ?
            WHERE id = ?
        ''', (to_source_id, news_id))
        
        # –ï—Å–ª–∏ –≤—Å—ë –û–ö, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å (COMMIT)
        db.commit()
        print("–£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ")
        
    except Exception as e:
        # –ï—Å–ª–∏ –æ—à–∏–±–∫–∞, –æ—Ç–∫–∞—Ç–∏—Ç—å –≤—Å—ë (ROLLBACK)
        db.rollback()
        print(f"–û—à–∏–±–∫–∞: {e}")
        
    finally:
        db.close()
```

---

## üí° –ü–†–ê–ö–¢–ò–ö–ê: –ü–û–õ–ù–ê–Ø –ë–î –î–õ–Ø –ë–õ–û–ì–ê

```python
import sqlite3
from datetime import datetime

class NewsDatabase:
    def __init__(self, filename='blog.db'):
        self.filename = filename
        self.init_db()
    
    def get_connection(self):
        return sqlite3.connect(self.filename)
    
    def init_db(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"""
        db = self.get_connection()
        cursor = db.cursor()
        
        # –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS sources (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL UNIQUE,
                url TEXT,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # –¢–∞–±–ª–∏—Ü–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS news (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                title TEXT NOT NULL,
                description TEXT,
                source_id INTEGER NOT NULL,
                url TEXT UNIQUE,
                image_url TEXT,
                is_archived INTEGER DEFAULT 0,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (source_id) REFERENCES sources(id)
            )
        ''')
        
        # –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS users (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                username TEXT NOT NULL UNIQUE,
                email TEXT NOT NULL UNIQUE,
                password TEXT NOT NULL,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # –¢–∞–±–ª–∏—Ü–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS favorites (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                news_id INTEGER NOT NULL,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                UNIQUE(user_id, news_id),
                FOREIGN KEY (user_id) REFERENCES users(id),
                FOREIGN KEY (news_id) REFERENCES news(id)
            )
        ''')
        
        db.commit()
        db.close()
    
    def add_source(self, name, url=None):
        """–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫"""
        db = self.get_connection()
        cursor = db.cursor()
        cursor.execute(
            'INSERT INTO sources (name, url) VALUES (?, ?)',
            (name, url)
        )
        db.commit()
        db.close()
    
    def add_news(self, title, description, source_id, url, image_url=None):
        """–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å"""
        db = self.get_connection()
        cursor = db.cursor()
        cursor.execute('''
            INSERT INTO news (title, description, source_id, url, image_url)
            VALUES (?, ?, ?, ?, ?)
        ''', (title, description, source_id, url, image_url))
        db.commit()
        db.close()
    
    def get_recent_news(self, limit=10):
        """–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏"""
        db = self.get_connection()
        cursor = db.cursor()
        cursor.execute('''
            SELECT n.id, n.title, s.name, n.created_at
            FROM news n
            JOIN sources s ON n.source_id = s.id
            WHERE n.is_archived = 0
            ORDER BY n.created_at DESC
            LIMIT ?
        ''', (limit,))
        results = cursor.fetchall()
        db.close()
        return results
    
    def get_news_count_by_source(self):
        """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —Å–∫–æ–ª—å–∫–æ –Ω–æ–≤–æ—Å—Ç–µ–π –æ—Ç –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞"""
        db = self.get_connection()
        cursor = db.cursor()
        cursor.execute('''
            SELECT s.name, COUNT(n.id) as count
            FROM sources s
            LEFT JOIN news n ON s.id = n.source_id
            GROUP BY s.name
            ORDER BY count DESC
        ''')
        results = cursor.fetchall()
        db.close()
        return results

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
# db = NewsDatabase()
# db.add_source('BBC', 'https://bbc.com')
# db.add_news('–ó–∞–≥–æ–ª–æ–≤–æ–∫', '–û–ø–∏—Å–∞–Ω–∏–µ', 1, 'https://...')
# print(db.get_recent_news())
```

---

## üéì –ò–¢–û–ì–ò

–ü–æ—Å–ª–µ —ç—Ç–æ–π –≥–ª–∞–≤—ã —Ç—ã –∑–Ω–∞–µ—à—å:
- ‚úÖ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ SQL –∑–∞–ø—Ä–æ—Å—ã: SELECT, INSERT, UPDATE, DELETE
- ‚úÖ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å Python –∏ SQLite
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ
- ‚úÖ –û—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ SQL Injection
- ‚úÖ –ê–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ GROUP BY

**–í–µ—á–µ—Ä–æ–º –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Ç—ã:**
- –°–æ–∑–¥–∞—à—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- –î–æ–±–∞–≤–∏—à—å –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—ã
- –ü–æ–ª—É—á–∏—à—å –¥–∞–Ω–Ω—ã–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏
- –û–±–Ω–æ–≤–∏—à—å –∏ —É–¥–∞–ª–∏—à—å –∑–∞–ø–∏—Å–∏
- –°–≤—è–∂–µ—à—å —Ç–∞–±–ª–∏—Ü—ã –º–µ–∂–¥—É —Å–æ–±–æ–π
- –°–¥–µ–ª–∞–µ—à—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

---

**–ü–æ–º–Ω–∏:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î = —É—Å–ø–µ—à–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ! üóÑÔ∏è
